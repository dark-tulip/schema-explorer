## 0. Какие источники и приемники поддерживаются в Debezium?

сравнение:

In "JDBC Connector" you cannot capture DDL changes like new tables, columns etc. With Debezium connector you can track data structure changes so you also adjust the sink connector if it necesary.

- https://stackoverflow.com/questions/60908891/kafka-connect-jdbc-vs-debezium-cdc

Debezium поддерживает ряд источников данных для захвата изменений данных (CDC - Change Data Capture) и передачу их в системы-цели. Основные источники:

Базы данных:

```
MySQL: Захват изменений на уровне транзакционного лога (binlog).
PostgreSQL: Использование репликационного потока (logical replication).
MongoDB: Захват изменений через журнал операций (oplog)
SQL Server: Чтение данных через журнал транзакций (transaction log).
Oracle: Захват через Redo и архивные журналы.
Db2: Поддержка через лог транзакций.
```

Приемники (targets):

- Debezium сам по себе предназначен для передачи данных в Apache Kafka, а из Kafka данные могут быть переданы в любое хранилище или систему обработки данных с помощью Kafka Connect и различных Sink Connectors (например, Elasticsearch, HDFS, или системы аналитики).

Подробнее о поддерживаемых источниках: Официальная документация Debezium.

## 1. Какое API предоставляет система?
Debezium интегрируется с Kafka Connect и использует его API для настройки источников и приемников данных.

**Основные функциональные возможности:**

- **Захват изменений данных (CDC):** Debezium отслеживает изменения данных (вставки, обновления, удаления) в режиме реального времени с помощью журналов транзакций или других механизмов. Он реплицирует изменения из базы данных в Kafka в виде событий.
- **Конфигурация через API:** Debezium использует REST API Kafka Connect для создания и управления коннекторами. Пользователи могут добавлять новые источники данных, изменять параметры репликации и контролировать процесс передачи данных через этот API.

**Параметры операций:**

- Частота репликации: Репликация происходит в режиме реального времени по мере внесения изменений в базу данных.
- Параметры мониторинга: Debezium поддерживает метрики для мониторинга задержек и скорости репликации через JMX.

## 2. Как решается технологическая задача?
#### Используются ли триггеры, журналы транзакций, лог-снифинг, или иные подходы?

- с помощью журналов транзакций (transaction logs) и лог-снифинга (log sniffing).
- захват схемы и данных без необходимости использования триггеров,
- Чтение логов транзакций: Для баз данных, таких как MySQL, PostgreSQL и Oracle, Debezium читает логи транзакций (binlog, logical replication и т.д.).
- Журнал операций (oplog): В MongoDB Debezium использует журнал операций для отслеживания изменений.

Преимущества:
- низкое влияние на производительность базы данных
- обеспечение точной репликации всех изменений.

## 3. Дизайн системы. Описание системы, её ключевых компонентов.

**Ключевые компоненты системы Debezium:**

- Коннекторы (Connectors): Компоненты, которые подключаются к источникам данных и захватывают изменения. Каждый тип базы данных имеет свой собственный коннектор (например, debezium-connector-mysql, debezium-connector-postgresql).
- Kafka Connect: Это основа для управления и масштабирования потоков данных. Debezium использует Kafka Connect для подключения коннекторов к источникам и передачи данных в Kafka.
- Kafka Topics: Изменения данных, захваченные коннекторами, передаются в соответствующие темы Kafka в виде сообщений. Каждое изменение представляет собой событие, содержащее информацию об изменении (вставка, обновление, удаление).

**Ответственность компонентов:**

- Коннекторы: Отвечают за захват изменений данных с источника.
- Kafka Connect: Управляет коннекторами и их конфигурациями.
- Kafka: Используется для передачи и хранения событий изменений.

## 4. Какие форматы данных используются для передачи изменений?
- использует JSON и Avro для передачи изменений данных через Kafka.
- Avro поддерживает бинарное кодирование и сжатие схем.
- Поддержка сжатия данных обеспечивается на уровне Kafka

## 5. Технологический стек компонентов.
Основные технологии, используемые в Debezium:
- написан на Java, для совместимости с Kafka и Kafka Connect

## 6. Масштабируемость и производительность.
- Debezium обеспечивает высокую масштабируемость через горизонтальное масштабирование с помощью Kafka и Kafka Connect:

- Горизонтальное масштабирование: Kafka Connect позволяет распределять нагрузку на несколько узлов (workers), что увеличивает производительность при обработке больших объемов данных. Количество задач коннектора можно динамически увеличивать в зависимости от нагрузки.
- Вертикальное масштабирование: Производительность также можно улучшить за счет увеличения вычислительных ресурсов (CPU, память) на узлах.
- В случае большого объема данных, возможны временные задержки при репликации, однако Kafka Connect и Kafka Streams могут справляться с нагрузкой за счет распределения задач между несколькими узлами.

## 7. Как технологически система справляется с изменениями в схеме данных?
Debezium поддерживает изменения в схеме данных (например, добавление/удаление полей) через механизм схем (schemas). Когда изменяется схема таблицы, коннекторы Debezium автоматически передают новую схему в сообщения Kafka. Поддерживаются следующие сценарии:

- Добавление полей: Новые поля передаются в Kafka, и потребители данных могут обрабатывать их по мере необходимости.
- Удаление полей: При удалении полей они больше не будут включаться в события, но данные о прошлом состоянии остаются доступными в предыдущих сообщениях.

## 8. Возможность пользователям самим добавлять источники и таргеты.
Debezium предоставляет возможность пользователям самостоятельно добавлять источники через API Kafka Connect. Пользователи могут использовать REST API для настройки новых источников данных и передачи их в Kafka. Добавление целевых систем также может быть реализовано через Sink Connectors Kafka Connect.

## 9. Обработка потоков данных и аналитика.
Debezium интегрируется с различными инструментами для обработки и аналитики потоков данных. Некоторые из доступных технологий:

- Kafka Streams: Встроенная библиотека для обработки потоков данных в реальном времени.
- ksqlDB: SQL-платформа для работы с потоками данных.
- Apache Flink и Spark: Поддерживают сложную обработку и аналитику потоков данных.
- Debezium позволяет строить сложные аналитические сценарии поверх потоков данных, что делает его подходящим для обработки в реальном времени.

##### Простота интеграции и масштабируемость
Debezium использует Kafka Connect, что позволяет легко интегрировать его в существующую инфраструктуру и масштабировать систему:
- **Kafka Connect** сам по себе не решает задачу захвата изменений данных (CDC). Для того чтобы захватывать изменения в базе данных с использованием Kafka Connect, требуется специализированный коннектор CDC — и здесь на сцену выходит Debezium.
- **Debezium** — это специализированное решение для CDC
  Debezium — это набор коннекторов Kafka Connect, разработанных специально для захвата изменений данных (Change Data Capture, CDC). Debezium использует логи транзакций и передает эти изменения в Kafka

#### Почему просто Kafka Connect недостаточно?
- Стандартные коннекторы для баз данных в Kafka Connect не поддерживают полный захват изменений данных (CDC). В них происходит polling таблиц, что не так эффективно и надежно, как использование логов транзакций, как это делает Debezium.

#### Когда использовать Kafka Connect и когда Debezium?
- Если нужно подключать разные системы (файлы, базы данных, очереди, API и т.д.) и передавать их данные в Kafka или наоборот — вам подходит Kafka Connect с соответствующими коннекторами.
- Если задача — в реальном времени отслеживать изменения в базе данных, а не просто передавать данные — вам нужен Debezium, который использует CDC для захвата изменений и работает через инфраструктуру Kafka Connect.
  Заключение

